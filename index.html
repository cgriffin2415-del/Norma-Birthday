<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Norma's 80th Birthday Invitation</title>
    <meta name="description" content="You are cordially invited to celebrate Norma's 80th Birthday! April 11th, 2026.">
    <meta property="og:title" content="Norma's 80th Birthday Invitation">
    <meta property="og:description" content="Join us for a celebration! April 11th, 2026 at VYBZE Event Hall.">
    <meta property="og:image" content="assets/invitation-bg.jpg">
    <meta property="og:type" content="website">

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Newsreader:ital,opsz,wght@0,6..72,200..800;1,6..72,200..800&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&amp;display=swap" rel="stylesheet" />

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#a742f0", // Vibrant Lavender
                        "background-light": "#f7f6f8",
                        "background-dark": "#1a1022", // Deep Amethyst Base
                        "royal-cream": "#fff9f0",
                        "amethyst": "#473b54",
                        "cream": "#FDF5E6",
                    },
                    fontFamily: {
                        "display": ["Newsreader", "serif"],
                        "script": ["Great Vibes", "cursive"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        body {
            font-family: 'Newsreader', serif;
            min-height: 100vh; /* Changed from max(884px, 100dvh) for better mobile support */
        }
        .watercolor-bg {
            background: radial-gradient(circle at top right, #3b1d5c 0%, #1a1022 60%),
                        radial-gradient(circle at bottom left, #4a2574 0%, transparent 50%);
            position: relative;
            overflow: hidden;
        }
    .watercolor-bg::before {
    content: "";
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: url('https://images.unsplash.com/photo-1557683316-973673baf926?q=80&w=2029&auto=format&fit=crop')
    center/cover;
    opacity: 0.15;
    mix-blend-mode: overlay;
    pointer-events: none;
    }
    </style>
</head>

<body class="bg-background-dark text-royal-cream min-h-screen font-display overflow-x-hidden">

    <!-- Loading Screen -->
    <div id="loading-screen"
        class="fixed inset-0 z-[100] bg-[#191022] flex flex-col items-center justify-center transition-opacity duration-1000">
        <div class="text-center space-y-4">
            <h1 class="text-royal-cream text-4xl font-script animate-pulse">Loading with Love...</h1>
            <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto"></div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="app-container"
        class="relative min-h-screen w-full max-w-[480px] mx-auto flex flex-col shadow-2xl bg-[#191022] opacity-0 transition-opacity duration-1000">

        <!-- View 1: Invitation -->
        <div id="view-invitation" class="flex-1 flex flex-col relative watercolor-bg">
            <!-- Header -->
            <div class="flex items-center p-4 pb-2 justify-between z-10 w-full">
                <div class="text-royal-cream flex size-12 shrink-0 items-center justify-center placeholder-invisible"
                    style="visibility: hidden;">
                    <span class="material-symbols-outlined text-[24px]">arrow_back</span>
                </div>
                <h2
                    class="text-royal-cream/70 text-sm font-medium leading-tight tracking-widest uppercase flex-1 text-center pr-12">
                    Invitation</h2>
            </div>

            <!-- Content -->
            <div class="flex-1 flex flex-col items-center justify-center px-6 text-center py-8">
                <!-- Carousel Container -->
                <div class="w-full max-w-sm aspect-[4/5] relative mb-8 group">
                    <div
                        class="relative w-full h-full rounded-xl overflow-hidden shadow-2xl border border-white/10 bg-black">
                        <!-- Carousel Track -->
                        <div id="carousel-track" class="flex h-full w-full">
                            <!-- Clone of Slide 5 (For loop) -->
                            <div class="w-full h-full flex-shrink-0 relative"
                                style="background-image: url('assets/5.png'); background-size: cover; background-position: center;">
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-background-dark/80 via-transparent to-transparent">
                                </div>
                            </div>
                            <!-- Slide 1 -->
                            <div class="w-full h-full flex-shrink-0 relative"
                                style="background-image: url('assets/1.png'); background-size: cover; background-position: center;">
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-background-dark/80 via-transparent to-transparent">
                                </div>
                            </div>
                            <!-- Slide 2 -->
                            <div class="w-full h-full flex-shrink-0 relative"
                                style="background-image: url('assets/2.png'); background-size: cover; background-position: center;">
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-background-dark/80 via-transparent to-transparent">
                                </div>
                            </div>
                            <!-- Slide 3 -->
                            <div class="w-full h-full flex-shrink-0 relative"
                                style="background-image: url('assets/3.png'); background-size: cover; background-position: center;">
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-background-dark/80 via-transparent to-transparent">
                                </div>
                            </div>
                            <!-- Slide 4 -->
                            <div class="w-full h-full flex-shrink-0 relative"
                                style="background-image: url('assets/4.png'); background-size: cover; background-position: center;">
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-background-dark/80 via-transparent to-transparent">
                                </div>
                            </div>
                            <!-- Slide 5 -->
                            <div class="w-full h-full flex-shrink-0 relative"
                                style="background-image: url('assets/5.png'); background-size: cover; background-position: center;">
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-background-dark/80 via-transparent to-transparent">
                                </div>
                            </div>
                            <!-- Clone of Slide 1 (For loop) -->
                            <div class="w-full h-full flex-shrink-0 relative"
                                style="background-image: url('assets/1.png'); background-size: cover; background-position: center;">
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-background-dark/80 via-transparent to-transparent">
                                </div>
                            </div>
                        </div>

                        <!-- Controls -->
                        <button onclick="prevSlide()"
                            class="absolute left-2 top-1/2 -translate-y-1/2 bg-black/30 hover:bg-black/50 text-white p-2 rounded-full cursor-pointer z-20 transition-all opacity-0 group-hover:opacity-100">
                            <span class="material-symbols-outlined text-sm">chevron_left</span>
                        </button>
                        <button onclick="nextSlide()"
                            class="absolute right-2 top-1/2 -translate-y-1/2 bg-black/30 hover:bg-black/50 text-white p-2 rounded-full cursor-pointer z-20 transition-all opacity-0 group-hover:opacity-100">
                            <span class="material-symbols-outlined text-sm">chevron_right</span>
                        </button>

                        <!-- Indicators -->
                        <!-- Indicators -->
                        <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-1 z-20">
                            <button onclick="goToSlide(0)"
                                class="w-2 h-2 rounded-full bg-white transition-all carousel-dot"></button>
                            <button onclick="goToSlide(1)"
                                class="w-2 h-2 rounded-full bg-white/50 transition-all carousel-dot"></button>
                            <button onclick="goToSlide(2)"
                                class="w-2 h-2 rounded-full bg-white/50 transition-all carousel-dot"></button>
                            <button onclick="goToSlide(3)"
                                class="w-2 h-2 rounded-full bg-white/50 transition-all carousel-dot"></button>
                            <button onclick="goToSlide(4)"
                                class="w-2 h-2 rounded-full bg-white/50 transition-all carousel-dot"></button>
                        </div>
                    </div>

                    <!-- Decorative BG Blurs -->
                    <div class="absolute -top-4 -right-4 w-24 h-24 bg-primary/20 rounded-full blur-3xl -z-10"></div>
                    <div class="absolute -bottom-6 -left-6 w-32 h-32 bg-primary/10 rounded-full blur-3xl -z-10"></div>
                </div>

                <!-- Text Content -->
                <div class="space-y-4 mb-8">
                    <p class="text-primary font-medium tracking-[0.2em] uppercase text-xs">You are cordially invited to
                    </p>
                    <h1
                        class="text-royal-cream text-5xl md:text-6xl font-normal leading-tight font-script drop-shadow-lg">
                        Celebrating <br />Norma's 80th
                    </h1>
                </div>

                <!-- Details -->
                <div
                    class="mt-4 space-y-6 max-w-xs w-full backdrop-blur-sm bg-white/5 p-6 rounded-2xl border border-white/5 shadow-xl">
                    <div class="flex flex-col items-center gap-1">
                        <span class="material-symbols-outlined text-primary/80 mb-1 text-3xl"
                            data-icon="calendar_today">calendar_today</span>
                        <h2 class="text-royal-cream text-xl font-semibold tracking-tight">April 11th, 2026</h2>
                        <p class="text-royal-cream/60 text-sm">Saturday from 8:00 PM - 12:00 AM</p>
                        <a href="https://calendar.google.com/calendar/r/eventedit?text=Norma%27s+80th+Birthday+Celebration&dates=20260412T000000Z/20260412T040000Z&details=Celebrating+Norma%27s+Diamond+Jubilee!&location=VYBZE+Event+Hall,+Stonecrest,+GA"
                            class="text-primary text-xs hover:underline mt-1">Add to Calendar</a>
                    </div>
                    <div class="w-12 h-[1px] bg-primary/30 mx-auto"></div>
                    <div class="flex flex-col items-center gap-1">
                        <span class="material-symbols-outlined text-primary/80 mb-1 text-3xl"
                            data-icon="location_on">location_on</span>
                        <h2 class="text-royal-cream text-lg font-medium">VYBZE Event Hall</h2>
                        <p class="text-royal-cream/70 text-sm">Stonecrest, GA</p>
                        <a href="https://maps.google.com/?q=VYBZE+Event+Hall+Stonecrest+GA" target="_blank"
                            class="text-primary text-xs hover:underline mt-1">Get Directions</a>
                    </div>
                </div>
            </div>

            <!-- Footer / Action -->
            <div class="p-8 pb-12 flex flex-col items-center z-10 w-full relative">
                <p class="mb-4 text-royal-cream font-medium text-sm letter-spacing-wide">Please RSVP by March 1st, 2026
                </p>

                <button onclick="switchView('rsvp')"
                    class="w-full max-w-sm bg-primary hover:bg-primary/90 text-white font-bold py-4 px-8 rounded-full shadow-[0_8px_30px_rgb(167,66,240,0.3)] transition-all transform active:scale-95 flex items-center justify-center gap-2 group cursor-pointer">
                    <span class="material-symbols-outlined group-hover:animate-bounce" data-icon="mail">mail</span>
                    <span>Continue to RSVP page</span>
                </button>

                <p class="mt-6 text-royal-cream/30 text-[10px] uppercase tracking-widest">Designed by AI Empire Studio
                </p>
            </div>

            <!-- Padding for music button -->
            <div class="h-16"></div>
        </div>

        <!-- View 2: RSVP (Hidden by default) -->
        <div id="view-rsvp" class="hidden flex-1 flex-col relative watercolor-bg">
            <div class="flex items-center p-6 pb-4 justify-between sticky top-0 z-10 bg-[#191022]/80 backdrop-blur-md">
                <button onclick="switchView('invitation')"
                    class="text-cream flex size-10 shrink-0 items-center justify-center rounded-full hover:bg-white/10">
                    <span class="material-symbols-outlined">chevron_left</span>
                </button>
                <h1 class="text-cream text-xl font-bold leading-tight tracking-tight flex-1 text-center italic pr-10">
                    RSVP for Norma's 80th
                </h1>
            </div>

            <form id="rsvp-form" class="flex flex-col gap-8 px-6 py-4 pb-12" action="#" method="POST">
                <div class="w-full h-48 rounded-2xl overflow-hidden relative shadow-2xl border border-cream/10">
                    <img alt="Elegant party background" class="w-full h-full object-cover"
                        src="assets/rsvp-party.jpg" />
                    <div class="absolute inset-0 bg-gradient-to-t from-[#191022]/90 via-transparent to-transparent">
                    </div>
                    <div class="absolute bottom-5 left-5">
                        <p class="text-[10px] uppercase tracking-[0.3em] font-medium text-cream/70 mb-1">Royal
                            Celebration</p>
                        <p class="text-xl font-bold italic">Norma's Diamond Jubilee</p>
                    </div>
                </div>

                <div class="flex flex-col gap-6">
                    <div class="flex flex-col gap-3">
                        <label class="text-cream font-semibold text-lg ml-1 italic">Will you be attending?</label>
                        <div class="grid grid-cols-2 gap-3">
                            <div class="relative">
                                <input checked="" class="hidden peer" id="attending" name="Attendance" type="radio"
                                    value="yes" />
                                <label
                                    class="flex items-center justify-center h-14 rounded-2xl border border-cream/20 bg-amethyst/20 text-cream cursor-pointer transition-all peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white font-medium"
                                    for="attending">
                                    Attending
                                </label>
                            </div>
                            <div class="relative">
                                <input class="hidden peer" id="unable" name="Attendance" type="radio" value="no" />
                                <label
                                    class="flex items-center justify-center h-14 rounded-2xl border border-cream/20 bg-amethyst/20 text-cream cursor-pointer transition-all peer-checked:bg-primary peer-checked:border-primary peer-checked:text-white font-medium"
                                    for="unable">
                                    Unable to Attend
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col gap-2.5">
                        <label class="text-cream font-semibold text-lg ml-1 italic" for="fullname">Full Name</label>
                        <input id="fullname" name="Fullname"
                            class="w-full rounded-2xl border border-cream/20 bg-amethyst/20 h-16 px-5 text-cream focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-cream/30 text-lg"
                            placeholder="Enter your full name" type="text" required />
                    </div>

                    <div class="flex flex-col gap-2.5">
                        <label class="text-cream font-semibold text-lg ml-1 italic" for="guests">Number of
                            Guests</label>
                        <div class="relative">
                            <select id="guests" name="Guests"
                                class="w-full appearance-none rounded-2xl border border-cream/20 bg-amethyst/20 h-16 px-5 text-cream focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all text-lg cursor-pointer">
                                <option class="bg-background-dark" disabled="" selected="" value="">Select number
                                </option>
                                <option class="bg-background-dark" value="1">Just me (1)</option>
                                <option class="bg-background-dark" value="2">Two (2)</option>
                                <option class="bg-background-dark" value="3">Three (3)</option>
                                <option class="bg-background-dark" value="4">Four (4)</option>
                                <option class="bg-background-dark" value="5+">Five+</option>
                            </select>
                            <span
                                class="material-symbols-outlined absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-cream/40">
                                expand_more
                            </span>
                        </div>
                    </div>

                    <div class="flex flex-col gap-2.5">
                        <label class="text-cream font-semibold text-lg ml-1 italic" for="relationship">Relationship to
                            Norma</label>
                        <input id="relationship" name="Relationship"
                            class="w-full rounded-2xl border border-cream/20 bg-amethyst/20 h-16 px-5 text-cream focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-cream/30 text-lg"
                            placeholder="e.g. Family, Friend, Colleague" type="text" />
                    </div>

                    <div class="flex flex-col gap-2.5">
                        <label class="text-cream font-semibold text-lg ml-1 italic" for="message">Message / Memory for
                            Norma</label>
                        <textarea id="message" name="Message"
                            class="w-full rounded-2xl border border-cream/20 bg-amethyst/20 p-5 text-cream focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-cream/30 resize-none text-lg"
                            placeholder="Share a warm wish or favorite memory..." rows="4"></textarea>
                    </div>

                    <div class="flex flex-col gap-2.5">
                        <label class="text-cream font-semibold text-lg ml-1 italic" for="accessibility">Accessibility
                            Needs <span class="text-sm font-normal opacity-60">(Optional)</span></label>
                        <input id="accessibility" name="Accessibility"
                            class="w-full rounded-2xl border border-cream/20 bg-amethyst/20 h-16 px-5 text-cream focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-cream/30 text-lg"
                            placeholder="Dietary or physical requirements" type="text" />
                    </div>

                    <div class="flex flex-col gap-2.5">
                        <label class="text-cream font-semibold text-lg ml-1 italic" for="contact">Email or Phone
                            Number</label>
                        <input id="contact" name="Contact"
                            class="w-full rounded-2xl border border-cream/20 bg-amethyst/20 h-16 px-5 text-cream focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-cream/30 text-lg"
                            placeholder="How we can reach you" type="text" required />
                    </div>
                </div>

                <div class="pt-4 flex flex-col gap-4">
                    <button type="submit"
                        class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-5 px-6 rounded-2xl shadow-[0_12px_24px_rgba(140,37,244,0.4)] transition-all flex items-center justify-center gap-3 active:scale-[0.98] text-lg">
                        Submit RSVP
                        <span class="material-symbols-outlined">celebration</span>
                    </button>

                    <div class="text-center flex flex-col gap-2">
                        <p class="text-cream font-medium italic text-lg">We can't wait to celebrate with you!</p>
                        <p class="text-cream/40 text-sm italic tracking-wide">
                            Please respond by March 1st, 2026
                        </p>
                    </div>
                </div>
            </form>

            <!-- Padding for music button -->
            <div class="h-16"></div>
        </div>

        <!-- Sticky Music Button Container (Inside App Container) -->
        <div class="sticky bottom-6 w-full flex justify-end px-6 pointer-events-none">
            <button id="music-toggle"
                class="pointer-events-auto bg-white/10 backdrop-blur-md border border-white/20 text-royal-cream p-3 rounded-full shadow-lg hover:bg-white/20 transition-all animate-pulse transform hover:scale-105 active:scale-95">
                <span class="material-symbols-outlined" id="music-icon">play_arrow</span>
            </button>
        </div>
    </div>

    <!-- Audio Player (Global) -->
    <audio id="bg-music" loop autoplay>
        <source src="assets/music.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        // Loading Screen Logic
        window.addEventListener('load', () => {
            const loader = document.getElementById('loading-screen');
            const app = document.getElementById('app-container');

            // Short delay to ensure texture/fonts are ready
            setTimeout(() => {
                loader.style.opacity = '0';
                app.style.opacity = '1';

                // Remove loader from DOM after transition
                setTimeout(() => {
                    loader.style.display = 'none';
                }, 1000);

                // Try to start music after loading
                startMusic();
            }, 1500);
        });

        // View Switching Logic
        function switchView(viewName) {
            const invitationView = document.getElementById('view-invitation');
            const rsvpView = document.getElementById('view-rsvp');

            if (viewName === 'rsvp') {
                invitationView.classList.add('hidden');
                invitationView.classList.remove('flex');
                rsvpView.classList.remove('hidden');
                rsvpView.classList.add('flex');
                window.scrollTo(0, 0);

                // Stop carousel when hidden
                clearInterval(slideInterval);
            } else {
                rsvpView.classList.add('hidden');
                rsvpView.classList.remove('flex');
                invitationView.classList.remove('hidden');
                invitationView.classList.add('flex');
                window.scrollTo(0, 0);

                // Resume carousel and reset stuck state
                isTransitioning = false;
                startCarousel();
            }
        }

        // Music Logic
        const audio = document.getElementById('bg-music');
        const musicBtn = document.getElementById('music-toggle');
        const musicIcon = document.getElementById('music-icon');
        let isPlaying = false;

        function startMusic() {
            audio.volume = 0.5;
            const playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    isPlaying = true;
                    musicIcon.textContent = 'pause';
                    musicBtn.classList.add('animate-pulse', 'bg-primary/50');
                }).catch(error => {
                    console.log("Autoplay prevented by browser");
                    isPlaying = false;
                    musicIcon.textContent = 'play_arrow';
                });
            }
        }

        function toggleMusic() {
            if (isPlaying) {
                audio.pause();
                musicIcon.textContent = 'play_arrow';
                musicBtn.classList.remove('animate-pulse', 'bg-primary/50');
            } else {
                audio.play().catch(e => console.log("Audio play failed:", e));
                musicIcon.textContent = 'pause';
                musicBtn.classList.add('animate-pulse', 'bg-primary/50');
            }
            isPlaying = !isPlaying;
        }

        musicBtn.addEventListener('click', toggleMusic);

        // Try autoplay on first click if initial load failed
        document.body.addEventListener('click', function () {
            if (!isPlaying) {
                startMusic();
            }
        }, { once: true });

        // Form Logic
        // Form Logic
        const ZAPIER_WEBHOOK_URL = "https://hooks.zapier.com/hooks/catch/26095985/uemqys2/";
        const rsvpForm = document.getElementById('rsvp-form');
        const submitBtn = rsvpForm.querySelector('button[type="submit"]');
        const originalBtnText = submitBtn.innerHTML;

        rsvpForm.addEventListener('submit', function (e) {
            e.preventDefault();

            // Set loading state
            submitBtn.disabled = true;
            submitBtn.innerHTML = `<span class="material-symbols-outlined animate-spin">progress_activity</span> Sending...`;

            // Collect data as URL parameters (Standard form encoding)
            // This avoids the "application/json" header which triggers the CORS preflight error
            const formData = new FormData(rsvpForm);
            const data = new URLSearchParams(formData);

            // Send to Zapier with no-cors and simple headers
            fetch(ZAPIER_WEBHOOK_URL, {
                method: 'POST',
                body: data,
                mode: 'no-cors'
                // No custom Content-Type header needed; URLSearchParams sets it to application/x-www-form-urlencoded
                // This is a "simple header" allowed by CORS without preflight.
            })
                .then(() => {
                    // Success (Opaque response)
                    submitBtn.innerHTML = `<span class="material-symbols-outlined">check_circle</span> Sent!`;
                    alert("Thank you! Your RSVP has been sent to Norma's list.");
                    rsvpForm.reset();
                    setTimeout(() => {
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = originalBtnText;
                    }, 3000);
                })
                .catch((error) => {
                    console.error('Error:', error);
                    alert("There was a network issue sending your RSVP. Please check your connection and try again.");
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                });
        });

        // Carousel Logic
        const track = document.getElementById('carousel-track');
        const dots = document.querySelectorAll('.carousel-dot');

        // We have 6 real slides, plus 2 clones = 8 total "track" items
        // Clones: [Clone 6] [Slide 1] [Slide 2] [Slide 3] [Slide 4] [Slide 5] [Slide 6] [Clone 1]
        // Indices:    0         1         2         3         4         5         6         7

        let currentIndex = 1; // Start at real Slide 1
        const totalSlides = 5;
        let isTransitioning = false;
        let slideInterval;

        // Initialize position
        track.style.transform = `translateX(-100%)`;

        track.addEventListener('transitionend', () => {
            isTransitioning = false;
            if (currentIndex === 0) {
                // We're at Clone 6, jump to real Slide 6
                track.style.transition = "none";
                currentIndex = totalSlides;
                track.style.transform = `translateX(-${currentIndex * 100}%)`;
            } else if (currentIndex === totalSlides + 1) {
                // We're at Clone 1, jump to real Slide 1
                track.style.transition = "none";
                currentIndex = 1;
                track.style.transform = `translateX(-${currentIndex * 100}%)`;
            }
        });

        function updateDots(index) {
            // Map track index to dot index (0-5)
            // 1->0, 2->1, ... 6->5
            // 0 (Clone 6) -> 5
            // 7 (Clone 1) -> 0

            let dotIndex;
            if (index === 0) dotIndex = totalSlides - 1;
            else if (index === totalSlides + 1) dotIndex = 0;
            else dotIndex = index - 1;

            dots.forEach((dot, i) => {
                if (i === dotIndex) {
                    dot.classList.remove('bg-white/50');
                    dot.classList.add('bg-white');
                } else {
                    dot.classList.remove('bg-white');
                    dot.classList.add('bg-white/50');
                }
            });
        }

        function showSlide(index) {
            if (isTransitioning) return;
            isTransitioning = true;

            track.style.transition = "transform 0.7s ease-in-out";
            currentIndex = index;
            track.style.transform = `translateX(-${currentIndex * 100}%)`;

            updateDots(currentIndex);
        }

        function nextSlide() {
            if (currentIndex >= totalSlides + 1) return;
            showSlide(currentIndex + 1);
        }

        function prevSlide() {
            if (currentIndex <= 0) return;
            showSlide(currentIndex - 1);
        }

        function goToSlide(dotIndex) {
            // dotIndex 0 (Slide 1) -> track index 1
            if (isTransitioning) return;
            track.style.transition = "transform 0.7s ease-in-out";
            currentIndex = dotIndex + 1;
            track.style.transform = `translateX(-${currentIndex * 100}%)`;
            updateDots(currentIndex);
            resetInterval();
        }

        function startCarousel() {
            slideInterval = setInterval(nextSlide, 4000);
        }

        function resetInterval() {
            clearInterval(slideInterval);
            startCarousel();
        }

        // Android Intent Fix for Calendar Deep Linking
        // Instead of relying on the browser to hand off properly (which fails on cold start),
        // we explicitly tell Android to open the Google Calendar app with the event data.
        document.addEventListener('DOMContentLoaded', () => {
            const isAndroid = /Android/i.test(navigator.userAgent);

            if (isAndroid) {
                const calendarLinks = document.querySelectorAll('a[href*="calendar.google.com"], a[href*="www.google.com/calendar"]');

                calendarLinks.forEach(link => {
                    // Extract the query parameters from the existing URL
                    const currentUrl = new URL(link.href);
                    const params = currentUrl.search; // e.g. "?text=..."

                    // Construct the intent URL
                    // intent://<path>?<query>#Intent;scheme=https;package=com.google.android.calendar;end;
                    // Path for eventedit is typically /calendar/r/eventedit

                    // We use the "scheme=https" to allow fallback to browser if app isn't installed,
                    // but the "package" forces the app if present.
                    const intentUrl = `intent://calendar.google.com/calendar/r/eventedit${params}#Intent;scheme=https;package=com.google.android.calendar;end;`;

                    link.href = intentUrl;
                });
            }
        });

        // Initialize
        updateDots(currentIndex);
        startCarousel();
    </script>
</body>

</html>